---
- name: Install with root privileges
  hosts: localhost
  become: true
  tasks:
        - name: Install apt packages
          apt:
                state: latest
                name:
                      - vim
                      - vim-syntastic
                      - git
                      - git-lfs
                      - git-restore-mtime
                      - dnsutils
                      - rsnapshot
                      - whois
                      - sshfs
                      # NFS client
                      - nfs-common
                      # bash helper
                      - command-not-found
                      - build-essential
                      - rsync

        - name: Set HISTTIMEFORMAT globaly
          lineinfile:
                dest: /etc/profile.d/timestamp.sh
                line: 'HISTTIMEFORMAT="%Y%m%d %T "'
                regex: 'HIST'
                create: true
                mode: "a+rx"


- name: Install user preferences
  hosts: localhost
  tasks:
        # https://www.freecodecamp.org/news/bashrc-customization-guide/
        - name: Set bash env 1
          blockinfile:
                path: ~/.bashrc
                block: |
                  export SSH_AUTH_SOCK=$(gpgconf --list-dirs agent-ssh-socket)
                  gpgconf --launch gpg-agent

                  HISTTIMEFORMAT="%F %T "
                  alias cd..='cd ..'
                  alias ..='cd ..;pwd'
                  alias ...='cd ../..;pwd'
                  alias ....='cd ../../..;pwd'

        - name: Set bash env HISTSIZE
          lineinfile:
                dest: ~/.bashrc
                line: 'HISTSIZE=9000'
                regex: 'HISTSIZE='
        - name: Set bash env HISTFILESIZE
          lineinfile:
                dest: ~/.bashrc
                line: 'HISTFILESIZE=9000'
                regex: 'HISTFILESIZE='
